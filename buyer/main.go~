package main

import (
	"net"
	"bufio"
	"fmt"
	"oc/buyer/client"
	"oc/msg"
	"log"
)

func main() {
	println("buyer main")
	conn, err := net.Dial("tcp", "localhost:9443")
	if err != nil {
		log.Fatal("error while dialing: ", err)
	}

	req := client.NewCalcReq([]string{"1 4 +", "2 30.2 -"})
	b64 := string(msg.EncodeReq(&req))
	fmt.Fprintf(conn, b64 + "\n")
	resp, err := bufio.NewReader(conn).ReadString('\n')
	println("got response: ", resp)
}
