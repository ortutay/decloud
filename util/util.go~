package util

import (
	"os"
)

func StoreAppData(filename string, data []byte, perm os.FileMode) error {
	err := makeDir()
	if err != nil {
		return err
	}
	f, err := os.Create(appDir() + "/" + filename)
	if err != nil {
		return err
	}
	err = f.Chmod(perm)
	if err != nil {
		return err
	}
	_, err = f.Write(data)
	if err != nil {
		return err
	}
	return nil
}

func appDir() string {
	return os.Getenv("HOME") + "/.oc"
}

func makeDir() error {
	err := os.Mkdir(appDir(), 0775)
	if os.IsExist(err) {
		return nil
	} else {
		return err
	}
}
